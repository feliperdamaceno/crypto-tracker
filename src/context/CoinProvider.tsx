// Hooks
import { ReactNode, createContext, useState } from 'react'
import { Line } from 'react-chartjs-2'
import { useQuery } from '@tanstack/react-query'

// Libs
import axios from 'axios'

// Types
import {
  CoinContextType,
  CoinState,
  Currencies,
  Coin,
  TrendingCoin
} from '../types/CoinTypes'

const MOCK_DATA: Coin[] = [
  {
    id: 'bitcoin',
    symbol: 'btc',
    name: 'Bitcoin',
    image:
      'https://assets.coingecko.com/coins/images/1/large/bitcoin.png?1547033579',
    current_price: 26259,
    market_cap: 507720685532,
    market_cap_rank: 1,
    fully_diluted_valuation: 551229064335,
    total_volume: 11636244223,
    high_24h: 26250,
    low_24h: 25375,
    price_change_24h: 872.76,
    price_change_percentage_24h: 3.43791,
    market_cap_change_24h: 16711272643,
    market_cap_change_percentage_24h: 3.40345,
    circulating_supply: 19342475,
    total_supply: 21000000,
    max_supply: 21000000,
    ath: 59717,
    ath_change_percentage: -56.06178,
    ath_date: '2021-11-10T14:24:11.849Z',
    atl: 51.3,
    atl_change_percentage: 51048.78401,
    atl_date: '2013-07-05T00:00:00.000Z',
    roi: null,
    last_updated: '2023-04-10T15:51:14.674Z',
    sparkline_in_7d: {
      price: [
        28298.63388116931, 28181.076894144888, 28257.79514031741,
        28054.965491108025, 28062.580504620128, 28045.57857633993,
        28025.392925692067, 28183.587869681913, 28115.525959322884,
        27629.00805255512, 27832.500814526797, 27832.4729690141,
        27815.42653124798, 27789.60027092099, 27855.86054002738,
        27931.757218125018, 27911.60390022797, 27845.144820465222,
        27935.229910451228, 28138.451687039073, 28013.378286016043,
        28088.674361572674, 28182.64756150609, 28233.343436881743,
        28305.012139287173, 28280.005005551244, 28129.4876628722,
        28195.613349729876, 28051.714934238462, 28111.743520868433,
        28204.780999548057, 28209.17134671452, 28194.775836923025,
        28311.006512969114, 28223.534205566517, 28229.870793863745,
        28175.33033421539, 28467.098329710636, 28616.1654711853,
        28568.412144461367, 28511.586549751024, 28523.660413248697,
        28577.315767234333, 28555.60474457757, 28522.720117964443,
        28578.94571421836, 28527.119485595544, 28508.37797334716,
        28540.125449830215, 28576.71707026462, 28403.32255039985,
        28167.405631498907, 28118.758778204396, 27960.768503055657,
        28022.96485955483, 28030.073152594723, 28276.702324588,
        28207.37419373004, 28181.78768914216, 28194.864572057726,
        28185.509968749175, 28061.452699181464, 28064.131795516765,
        28029.07557290946, 28136.789291806756, 28088.427031627973,
        28043.43911097702, 28059.8854898523, 27929.280784864164,
        27951.95931334892, 27989.51347610333, 27866.437547413134,
        27939.50566925594, 27874.404457766424, 27899.528059674944,
        27965.875444715333, 28156.56490964856, 28087.463899253653,
        28062.944929115787, 27998.075648190174, 28070.89754413554,
        28075.385232439232, 28028.726972880282, 28012.220258922647,
        28042.9833864884, 28121.824614606016, 28071.38923437073,
        28012.101384307414, 28060.134312723243, 28023.40401567159,
        27979.492657550803, 27938.033805240044, 27845.125226342465,
        27886.117833445598, 27872.043520856463, 27965.342779685536,
        27916.86814865087, 27926.70337175087, 27910.38227919518,
        27961.555402959537, 27966.44367611709, 27894.923599598762,
        27927.326050110547, 27910.667986782606, 27917.554973574097,
        27899.578666999812, 27914.9390603559, 27975.950144332335,
        27945.530505731716, 27904.39561420768, 27937.47367094155,
        27951.969766969676, 28037.041366525675, 28029.289883468948,
        28109.4330812567, 28136.87048223328, 28129.69444231073,
        28091.538319585714, 28086.811286404296, 28047.76448644178,
        28071.531282923374, 28002.909330869083, 28061.743273789867,
        28066.911619599476, 28024.709456655077, 28018.650380897412,
        27971.009627459156, 27951.213431947945, 27957.212123463014,
        27953.272573168488, 27961.592462831148, 27962.37430306412,
        27968.12804705512, 28070.12385783608, 28115.882284873354,
        28057.387111744894, 28066.650685008426, 28062.060906807186,
        28025.61768735184, 27972.494181835697, 27934.57277652199,
        27931.82919389994, 27957.86559842035, 27920.185956487334,
        27979.60682202939, 27958.561767014442, 27957.331164986823,
        27910.941746896464, 27911.066986243157, 27918.941544448146,
        27947.574925896835, 28020.11911600868, 28139.520235730346,
        28125.34427397842, 28445.40629280062, 28451.996772761897,
        28351.23699385011, 28412.12039726956, 28311.646161951114,
        28329.770191293755, 28340.797815780432, 28272.69943593812,
        28265.89113654399, 28330.260698422673, 28286.68490746672,
        28325.876622886393, 28314.22212848336, 28353.153747104603
      ]
    },
    price_change_percentage_1h_in_currency: 0.32916761067760447,
    price_change_percentage_24h_in_currency: 3.437907931988901,
    price_change_percentage_7d_in_currency: 0.48959624309509364
  },
  {
    id: 'ethereum',
    symbol: 'eth',
    name: 'Ethereum',
    image:
      'https://assets.coingecko.com/coins/images/279/large/ethereum.png?1595348880',
    current_price: 1718.14,
    market_cap: 206859563411,
    market_cap_rank: 2,
    fully_diluted_valuation: 206859563411,
    total_volume: 6872951698,
    high_24h: 1719.71,
    low_24h: 1671.49,
    price_change_24h: 45.64,
    price_change_percentage_24h: 2.72879,
    market_cap_change_24h: 5540459708,
    market_cap_change_percentage_24h: 2.75208,
    circulating_supply: 120438691.503363,
    total_supply: 120438691.503363,
    max_supply: null,
    ath: 4228.93,
    ath_change_percentage: -59.36645,
    ath_date: '2021-12-01T08:38:24.623Z',
    atl: 0.381455,
    atl_change_percentage: 450375.91588,
    atl_date: '2015-10-20T00:00:00.000Z',
    roi: {
      times: 86.45966025111068,
      currency: 'btc',
      percentage: 8645.966025111067
    },
    last_updated: '2023-04-10T15:51:15.862Z',
    sparkline_in_7d: {
      price: [
        1809.9270449189623, 1805.5329231073224, 1809.4566344128245,
        1796.78265479277, 1797.9117683698398, 1798.80462598411,
        1802.471664307543, 1833.9886007837588, 1822.410305835255,
        1788.4495562097732, 1801.5356470713566, 1806.730029855972,
        1810.466255484756, 1808.5143868811192, 1811.1135881643577,
        1812.1587678347623, 1810.8083425606528, 1807.528247971437,
        1811.276500773889, 1817.477422114872, 1814.9664519143903,
        1822.1136216469465, 1826.0595813879434, 1832.5969647646127,
        1865.4836682801574, 1868.4064687283849, 1863.8987097243496,
        1870.6795640223477, 1863.801250829072, 1866.805520683087,
        1869.9959787471957, 1870.5294081385873, 1868.997794731308,
        1879.5754143372665, 1871.3766074515374, 1868.78181463302,
        1872.6775753280547, 1903.4363975372412, 1915.2756119102144,
        1913.4650065053215, 1910.9738578003628, 1910.6001829008642,
        1912.7714458138735, 1913.6181626214789, 1910.4371085967875,
        1911.953138509016, 1910.1866217359877, 1912.1715632094836,
        1914.3926659066783, 1921.325940981293, 1913.5141773026535,
        1901.693271842277, 1903.2362150515867, 1894.315574453483,
        1898.4099790863368, 1899.541472783981, 1912.047568693222,
        1906.07540872623, 1911.0784041282293, 1910.563803359361,
        1909.804931874891, 1901.5150338511103, 1896.8330714220283,
        1893.442484088491, 1899.0143318136927, 1893.333512483768,
        1888.468919173738, 1890.6400606428936, 1879.715919324671,
        1880.9422990494656, 1880.4248431051606, 1864.3213923527483,
        1869.2260117806827, 1861.4843068510165, 1864.7289349852495,
        1868.5900261894888, 1876.5168633089875, 1878.1461922483143,
        1876.41852119227, 1869.2265262462577, 1873.89177141, 1873.1977758064736,
        1869.159296024667, 1869.4314043123584, 1872.2466823679094,
        1882.0507892972755, 1876.2568403116466, 1873.567340218435,
        1877.8539996218356, 1876.1021836609207, 1870.0685535590353,
        1865.7418952056148, 1851.8338755409065, 1853.6568485068856,
        1855.7193911531542, 1859.3873324706651, 1852.779489606995,
        1855.8686134229335, 1855.232248560863, 1860.9239091341274,
        1860.882830729207, 1854.4307303510184, 1859.9474753794955,
        1856.1541881176456, 1857.1324506293433, 1854.3748927264912,
        1858.0031092856395, 1868.1974657378166, 1865.9925172644535,
        1857.960302147887, 1861.2448758425653, 1862.5006460565614,
        1870.0068353055508, 1868.398843116347, 1875.2826212766215,
        1875.9510776511263, 1875.1740782830243, 1872.75434290674,
        1875.2081939053287, 1871.2707533164976, 1871.1721004031738,
        1866.2532087986751, 1869.8042069986084, 1871.0868694435526,
        1867.709341996877, 1868.443846675408, 1862.9390330446483,
        1855.335636235777, 1855.7645584655188, 1857.483720896274,
        1855.9509017908788, 1852.7725754211506, 1851.0506710706206,
        1856.429559392251, 1861.020018689438, 1858.296988008122,
        1856.560045348455, 1855.67890777486, 1851.706643741729,
        1839.3820940001503, 1837.5140512497517, 1840.5273399075809,
        1839.290299327585, 1836.285053954051, 1841.3717477032471,
        1840.9395668098944, 1838.9722465576158, 1835.9621804422818,
        1838.7510849370888, 1840.5129628844315, 1842.1363582423521,
        1850.2964502948762, 1856.1616690359158, 1856.3078265537442,
        1870.2020603498413, 1869.3294986443163, 1859.9403872878142,
        1861.8927326093162, 1852.2414199820792, 1856.9709420426864,
        1861.8388741948752, 1859.3462671339114, 1859.9373320798215,
        1861.1952066336553, 1859.4590825292773, 1859.4861597878307,
        1858.26852290185, 1861.911078123656
      ]
    },
    price_change_percentage_1h_in_currency: 0.04975546907842114,
    price_change_percentage_24h_in_currency: 2.728787517217681,
    price_change_percentage_7d_in_currency: 3.2725221708113477
  },
  {
    id: 'tether',
    symbol: 'usdt',
    name: 'Tether',
    image:
      'https://assets.coingecko.com/coins/images/325/large/Tether.png?1668148663',
    current_price: 0.921216,
    market_cap: 74076865518,
    market_cap_rank: 3,
    fully_diluted_valuation: 74076865518,
    total_volume: 18724977041,
    high_24h: 0.924071,
    low_24h: 0.909747,
    price_change_24h: 0.01143372,
    price_change_percentage_24h: 1.25675,
    market_cap_change_24h: 1064015266,
    market_cap_change_percentage_24h: 1.4573,
    circulating_supply: 80210538011.0731,
    total_supply: 80210538011.0731,
    max_supply: null,
    ath: 1.13,
    ath_change_percentage: -18.38719,
    ath_date: '2018-07-24T00:00:00.000Z',
    atl: 0.533096,
    atl_change_percentage: 73.23916,
    atl_date: '2015-03-02T00:00:00.000Z',
    roi: null,
    last_updated: '2023-04-10T15:50:04.747Z',
    sparkline_in_7d: {
      price: [
        1.0011898916612376, 1.0002942616248665, 1.00051701824241,
        1.0025182564103605, 1.0005717463209762, 1.0016909434471504,
        1.001789789090634, 1.0005428039739608, 1.000131972537235,
        0.9996292852530693, 1.0041225527088682, 0.9999741334134691,
        1.0002890478121205, 1.001128019582081, 1.0016919718052248,
        1.001110874546146, 1.0009085396373794, 1.0012807357568845,
        1.0014350527088929, 1.0016281048715459, 1.001140910191837,
        0.9998432845056565, 1.0004771355903985, 0.9999232240863865,
        1.0004801582155305, 1.0007146837956427, 0.9998762297771415,
        1.0002435185281184, 1.0005551633663816, 1.0009314210528748,
        1.00065889800795, 1.0006637121394584, 1.0006288008223985,
        1.0011881617572502, 1.0004970241892437, 1.0009187916336733,
        1.0016760725115739, 1.0002255864456853, 1.0007497605800986,
        1.0016168481052783, 0.9998978211288414, 1.0004570683863439,
        1.0006729820980544, 1.0009950271051213, 1.0004195170139598,
        1.000700114322999, 1.000397431596209, 1.000206158268817,
        0.9998614974495151, 1.0009040384623216, 1.0004216375497545,
        1.0011135142181449, 1.001131981511786, 1.0003667331844874,
        0.9991454685436777, 1.0005381241795972, 0.9993095212533475,
        1.0002056087317979, 1.0012114841529136, 0.9998403696610032,
        1.0002090253376197, 1.0018109110871238, 1.000082569607431,
        1.0006346878531251, 1.0003145208247914, 1.000118138090198,
        1.000841295562874, 1.0000576740298688, 0.9997428718412491,
        1.0003174741049026, 1.001487907310861, 1.0013360630848982,
        1.000131343396107, 0.99976321262564, 1.002485427098215,
        1.0009761367824639, 1.001001886992191, 1.0005275743876245,
        1.0005815500097701, 0.9999310524083427, 1.0014283482806399,
        1.001171306551771, 1.001093353801815, 1.0004523796083753,
        1.000621433410576, 1.0009148749562138, 1.0004152576877752,
        1.0004857418605508, 1.000528864576752, 1.000042808934998,
        1.0000991124575007, 1.0001916407819171, 1.0011621513851363,
        1.000469026844896, 1.0000070403462085, 1.0010030873609883,
        1.002414287423035, 1.0008448733899493, 1.0008723398103299,
        1.0010888832049365, 1.0008064077943604, 1.0010379366409299,
        1.0008084170562328, 1.0005643534350235, 1.0008218719968984,
        1.0006495171571685, 1.00110066973255, 1.0013606184402795,
        1.0009807150553152, 1.001182248291676, 1.0012976384842585,
        1.0008752408574182, 1.0009512345576803, 1.0017367208057142,
        1.0017048223203742, 1.0009786019240545, 1.0016009142693298,
        1.0018841206796474, 1.001297157041792, 1.0015766312403678,
        1.0019869299658282, 1.0007875555697434, 1.001210990465818,
        1.0011899053643574, 1.0007530281291361, 1.0007563130152866,
        1.000747619459445, 1.0016521739198943, 1.000920557968804,
        1.0011941521861825, 1.0011955908779062, 1.001159763483776,
        1.0010214146819667, 1.0009071133883165, 1.001802755812103,
        1.001117814056367, 1.0016056527461927, 1.0016466763748433,
        1.0013923127825832, 1.0019393921170658, 1.0008221333347833,
        1.0024478563496868, 1.0014805949290133, 1.001075995440495,
        1.001965247801414, 1.0011382861846627, 1.00179396931234,
        1.0009065652644555, 1.0002596980176404, 1.0014624129201533,
        1.0015649688904782, 1.0015670854335317, 1.0002446114128498,
        1.0007042522456842, 1.0020182705468392, 1.0018897547605496,
        1.0013587032512785, 1.0010994627964822, 1.0005925688603439,
        1.0005383244041526, 1.001908706495376, 1.0003299308584646,
        0.9998810906724561, 1.0013501886946672, 1.0005839587990863,
        1.0010857120757453, 1.0004643081864888, 1.0018051988040184
      ]
    },
    price_change_percentage_1h_in_currency: -0.29170588037088757,
    price_change_percentage_24h_in_currency: 1.2567537920364655,
    price_change_percentage_7d_in_currency: -0.6574134297902757
  },
  {
    id: 'binancecoin',
    symbol: 'bnb',
    name: 'BNB',
    image:
      'https://assets.coingecko.com/coins/images/825/large/bnb-icon2_2x.png?1644979850',
    current_price: 287.8,
    market_cap: 45414135567,
    market_cap_rank: 4,
    fully_diluted_valuation: 57524390593,
    total_volume: 463807897,
    high_24h: 288.2,
    low_24h: 282.42,
    price_change_24h: 5.39,
    price_change_percentage_24h: 1.9074,
    market_cap_change_24h: 828769482,
    market_cap_change_percentage_24h: 1.85884,
    circulating_supply: 157895234,
    total_supply: 157900174,
    max_supply: 200000000,
    ath: 583.17,
    ath_change_percentage: -50.58969,
    ath_date: '2021-11-26T02:58:28.000Z',
    atl: 0.03359941,
    atl_change_percentage: 857498.67701,
    atl_date: '2017-10-19T00:00:00.000Z',
    roi: null,
    last_updated: '2023-04-10T15:51:20.793Z',
    sparkline_in_7d: {
      price: [
        312.4583680509677, 312.35918967923226, 312.2775920003249,
        310.44781086031367, 310.5047845806311, 309.34687015530204,
        309.89777966411236, 311.57556586510304, 311.9274831885071,
        302.0219167452582, 306.9821828691783, 307.18703359572265,
        308.84608796598565, 309.3218352334993, 309.03905378262635,
        309.702789715178, 309.93864231445224, 309.7251064547963,
        310.16790853349994, 310.74512537349125, 309.77519548908793,
        310.1941847195494, 310.60896535631446, 309.9803425509217,
        310.84824961868935, 311.4893770278732, 310.8298450484704,
        311.46048140517786, 311.1348777544264, 311.08442803771214,
        311.295951691107, 311.45584644437173, 311.5607804491205,
        311.77627113455736, 311.3079440744891, 311.1296572526514,
        311.1353656609566, 312.140961242313, 313.61450237862226,
        313.7476416269098, 314.6381279710165, 314.2028613430383,
        315.4794783670242, 315.59443229009156, 314.8396811100598,
        314.9723197358092, 314.8833426419017, 314.88896011418586,
        315.5034093891177, 315.2938203108351, 315.12394250728715,
        313.24480632210634, 312.5532335424498, 311.73714725731645,
        312.0173626977276, 312.3471914950052, 313.5520664070778,
        314.18141793927185, 314.70692396419855, 314.47172736721996,
        314.13017319502956, 313.1799416629873, 312.3164436546016,
        312.71033210757855, 314.2075419447544, 314.3754402512758,
        313.5968560052933, 313.80405029767354, 311.96487421472693,
        312.7003776237832, 312.41584901966496, 311.72035384707,
        311.9946436123498, 312.02508579497174, 312.4456162299181,
        312.5804983079267, 313.3686725649823, 312.9766608369545,
        312.81859487026975, 312.3439598551744, 312.7274454991342,
        312.9426305211563, 312.590690834422, 312.66791880029444,
        312.3686479069641, 312.9492277310436, 312.2824270237682,
        311.69337840389073, 311.9071972846105, 311.4360187774033,
        311.63623415496886, 311.2311069798422, 310.49655106467765,
        310.1933677958929, 310.3492844198448, 310.7744835739651,
        310.9413615924223, 310.71646388067023, 310.63203420672374,
        311.2330280238724, 311.3418539198911, 310.74408394459107,
        311.27412244297153, 311.1475616621075, 311.0108407875532,
        311.0528706411778, 310.95778469764986, 311.51132500080746,
        310.75746278652537, 310.9366246251016, 311.09426233387313,
        311.1822941981143, 311.77457679816825, 311.9157842811331,
        312.40714847957275, 312.209377487061, 312.45915266017096,
        312.3301142940676, 312.4845671218374, 312.4102535011961,
        312.3422938830964, 311.6470743467608, 312.01448072872375,
        312.4612953029939, 312.3524357473648, 312.5799780608589,
        312.2666115985151, 311.32608654290755, 310.9575470076406,
        311.00717928319364, 310.94307185556715, 310.80466002870907,
        310.6618311940004, 311.167325016835, 311.88860910111003,
        311.5295436759744, 311.6957290029027, 311.5835803690541,
        311.20234400558036, 310.59373198643243, 310.25048637226257,
        310.1495582636289, 310.2991002906514, 310.4458195821805,
        310.831864243991, 311.2455994172031, 311.11190326338624,
        310.4606706448801, 310.50370491539775, 311.04618632778,
        310.8531358172241, 311.35594632558843, 311.7046184850383,
        312.2507089983693, 313.0065196837387, 313.65738467890526,
        313.01127725660405, 312.6854983868781, 312.5307424115363,
        312.58577376501336, 313.4141426649775, 312.92957317269855,
        313.23856042594525, 313.02602622124266, 312.92171344822606,
        313.18249555671946, 312.9965469289151, 313.1777210451498
      ]
    },
    price_change_percentage_1h_in_currency: -0.1314899062942852,
    price_change_percentage_24h_in_currency: 1.907400150795793,
    price_change_percentage_7d_in_currency: -0.9933709328454924
  }
]

const MOCK_TRENDING: TrendingCoin[] = [
  {
    id: 'arbitrum',
    coin_id: 16547,
    name: 'Arbitrum',
    symbol: 'ARB',
    market_cap_rank: 42,
    thumb:
      'https://assets.coingecko.com/coins/images/16547/thumb/photo_2023-03-29_21.47.00.jpeg?1680097630',
    small:
      'https://assets.coingecko.com/coins/images/16547/small/photo_2023-03-29_21.47.00.jpeg?1680097630',
    large:
      'https://assets.coingecko.com/coins/images/16547/large/photo_2023-03-29_21.47.00.jpeg?1680097630',
    slug: 'arbitrum',
    price_btc: 0.00004149671359728116,
    score: 0
  },
  {
    id: 'ovr',
    coin_id: 13429,
    name: 'Ovr',
    symbol: 'OVR',
    market_cap_rank: 838,
    thumb:
      'https://assets.coingecko.com/coins/images/13429/thumb/ovr_logo.png?1608518911',
    small:
      'https://assets.coingecko.com/coins/images/13429/small/ovr_logo.png?1608518911',
    large:
      'https://assets.coingecko.com/coins/images/13429/large/ovr_logo.png?1608518911',
    slug: 'ovr',
    price_btc: 0.00001097210190796068,
    score: 1
  }
]

export const CoinContext = createContext<CoinContextType>(null!)

interface CoinProviderProps {
  children: ReactNode
}

export default function CoinProvider({ children }: CoinProviderProps) {
  const [currency, setCurrency] = useState<Currencies>('EUR')
  const [trending, setTrending] = useState<TrendingCoin[]>([])
  const [coins, setCoins] = useState<Coin[]>([])

  const { status } = useQuery({
    queryKey: ['coins'],
    queryFn: () => axios.get('https://jsonplaceholder.typicode.com/todos'),
    onSuccess: (response) => {
      // setCoins(response.data)
      setCoins(MOCK_DATA)
      setTrending(MOCK_TRENDING)
    }
  })

  function updateCurrency(currency: Currencies) {
    setCurrency(currency)
  }

  const data: CoinState = {
    trending,
    coins
  }

  return (
    <CoinContext.Provider value={{ data, status, currency, updateCurrency }}>
      {children}
    </CoinContext.Provider>
  )
}
